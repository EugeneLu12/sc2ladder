{% extends "base.html" %}
{% set active_page = "search" %}
{% set has_search_bar = True %}

{% block css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/search.css')}}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar.css')}}">
{% endblock %}

{% block content %}
{% if pages_required > -1 %}
  <table class="resultsTable">
    <thead>
      <tr>
        <th>Region</th>
        <th>Rank</th>
        <th>Character Name</th>
        <th>Battle Net ID</th>
        <th>Race</th>
        <th>MMR</th>
        <th>Wins</th>
        <th>Losses</th>
      </tr>
    </thead>
    <tbody>
      {% for player in players %}
        <tr>
          <td>{{ player[0] }}</td>
          <td><img src="static/assets/img/{{ player[1] }}.png" class="icon"></td>
          {% if player[8] != None %}
            <td>[{{ player[8] }}]{{ player[2][:player[2].index("#")] }}</td>
          {% else %}
            <td>{{ player[2][:player[2].index("#")] }}</td>
          {% endif %}
          <td>{{ player[3] }}</td>
          <td><img src="static/assets/img/{{ player[4] }}.png" class="icon"></td>
          <td>{{ player[5] }}</td>
          <td>{{ player[6] }}</td>
          <td>{{ player[7] }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <table class="footer">
    <tr>
        {% if pages_required > 12 %}
          {% if page_number < 8 %}
            {% for i in range(0, page_number + 4) %}
              {% if i + 1 == page_number %}
                <td id="onPage">{{ i + 1 }}</td>
              {% else %}
                <td><a href="?region={{ region }}&page={{ i + 1 }}">{{ i + 1 }}</a></td>
            {% endif %}
            {% endfor %}
            <td>...</td>
            {% for i in range(pages_required - 4, pages_required) %}
              <td><a href="?region={{ region }}&page={{ i + 1 }}">{{ i + 1 }}</a></td>
            {% endfor %}
          {% elif page_number < pages_required - 8 %}
            {% for i in range(0, 4) %}
              <td><a href="?region={{ region }}&page={{ i + 1 }}">{{ i + 1 }}</a></td>
            {% endfor %}
            <td>...</td>
            {% for i in range(page_number - 4, page_number + 3) %}
              {% if i + 1 == page_number %}
                <td id="onPage">{{ i + 1 }}</td>
              {% else %}
                <td><a href="?region={{ region }}&page={{ i + 1 }}">{{ i + 1 }}</a></td>
              {% endif %}
            {% endfor %}
            <td>...</td>
            {% for i in range(pages_required - 4, pages_required) %}
              <td><a href="?region={{ region }}&page={{ i + 1 }}">{{ i + 1 }}</a></td>
            {% endfor %}
          {% else %}
            {% for i in range(0, 4) %}
              <td><a href="?region={{ region }}&page={{ i + 1 }}">{{ i + 1 }}</a></td>
            {% endfor %}
            <td>...</td>
            {% for i in range(page_number - 4, pages_required) %}
              {% if i + 1 == page_number %}
                <td id="onPage">{{ i + 1 }}</td>
              {% else %}
                <td><a href="?region={{ region }}&page={{ i + 1 }}">{{ i + 1 }}</a></td>
            {% endif %}
            {% endfor %}
          {% endif %}
        {% else %}
          {% for i in range(0, pages_required) %}
          <td>{{ i + 1 }}</td>
          {% endfor %}
        {% endif %}
      </tr>
    </table>
  {% else %}
  <table class="resultsTable">
    <tr><td><h1>No results found!</h1></td></tr>
  </table>
  {% endif %}
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/search.js')}}"></script>
  <script src="{{ url_for('static', filename='js/navBar.js')}}"></script>
{% endblock %}
</html>